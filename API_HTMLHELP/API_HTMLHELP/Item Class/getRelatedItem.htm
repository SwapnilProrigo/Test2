<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html><head><title>getRelatedItem</title>


	
	<link href="../style.css" rel="stylesheet" type="text/css">
	<meta content="PageBreeze Free HTML Editor (http://www.pagebreeze.com)" name="GENERATOR">
	<meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type"></head><body bgcolor="#ffffff">
<h1>Item Class</h1>

<h2><span class="identifier">getRelatedItem</span>()</h2>

<p align="left">Gets related item of the relationship.</p>

<h3>C#:</h3>

<h4>Item vendor = this.newItem("Vendor", "get");<br>
vendor.setProperty("name", "Allied Industries");<br>
vendor = vendor.apply();<br>
vendor.fetchRelationships("Vendor Part");<br>
Item relationships = vendor.getRelationships("Vendor Part");<br>
decimal total_price = 0;<br>
for (int i=0; i&lt;relationships.getItemCount(); i++) {<br>
&nbsp;Item partRel = relationships.getItemByIndex(i);<br>
&nbsp;Item vendorPart = <span style="background-color: rgb(255, 255, 0);">partRel.getRelatedItem()</span>;<br>
&nbsp;decimal unit_price = Convert.ToDecimal(vendorPart.getProperty("unit_price", "0"));<br>
&nbsp;&nbsp;&nbsp; total_price += unit_price;<br>
}<br>
return this.getInnovator().newResult(total_price.ToString());</h4>

<h3>VB:</h3>

<h4>Dim vendor As Item = Me.newItem("Vendor", "get")<br>
vendor.setProperty("name", "Allied Industries")<br>
vendor = vendor.apply()<br>
vendor.fetchRelationships("Vendor Part")<br>
Dim relationships As Item = vendor.getRelationships("Vendor Part")<br>
Dim total_price As Decimal = 0<br>
For i As Integer = 0 To relationships.getItemCount() - 1<br>
&nbsp;Dim partRel As Item = relationships.getItemByIndex(i)<br>
&nbsp;Dim vendorPart As Item = <span style="background-color: rgb(255, 255, 0);">partRel.getRelatedItem()</span><br>
&nbsp;Dim unit_price As Decimal = Convert.ToDecimal(vendorPart.getProperty("unit_price", "0"))<br>
&nbsp;total_price += unit_price<br>
Next<br>
Return Me.getInnovator().newResult(total_price.ToString())</h4>

<h3>Notes:</h3>

<p>&nbsp;If&nbsp; the related item can't be returned (e.g. 'this.dom'
doesn't have 'related_id' property or type of the related item is
unknown), the method returns null.</p>

<p>The examples above get the total unit price on a collection of Manufactured Parts associated with a Vendor.</p>
</body></html>