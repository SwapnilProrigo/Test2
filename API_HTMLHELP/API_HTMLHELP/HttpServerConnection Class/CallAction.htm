<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html><head><title>CallAction</title>


	
	<link href="../style.css" rel="stylesheet" type="text/css">
	<meta content="PageBreeze Free HTML Editor (http://www.pagebreeze.com)" name="GENERATOR">
	<meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type"></head><body bgcolor="#ffffff">
<h1>HttpServerConnection Class</h1>

<h2><span class="identifier">CallAction</span>(S<span class="nolink">tring</span> <span class="parameter">ctionName</span>, X<span class="nolink">mlDocument</span> <span class="parameter">inDOM</span>, <span class="nolink">XmlDocument</span> <span class="parameter">outDOM)</span><br>
&nbsp;</h2>

<p align="left">Send a request with the specified action and AML to Innovator server and write the obtained response into the <span class="code">outDOM</span>.</p>

<h3>C#:</h3>

<h4>string url = "http://localhost/InnovatorServer";<br>
string db = "InnovatorSolutions";<br>
string user = "admin";<br>
string pw = "innovator";</h4>

<h4>HttpServerConnection cnx = IomFactory.CreateHttpServerConnection(url, db, user, pw);<br>
Item login_result&nbsp; = cnx.Login();</h4>

<h4>XmlDocument doc = this.newXMLDocument();<br>
XmlElement root = doc.CreateElement("AML");<br>
XmlElement item = doc.CreateElement("Item");<br>
item.SetAttribute("type", "User");<br>
item.SetAttribute("action", "get");<br>
doc.AppendChild(root);<br>
root.AppendChild(item);</h4>

<h4>XmlDocument outDoc = this.newXMLDocument();</h4>

<h4><span style="background-color: rgb(255, 255, 0);">cnx.CallAction("ApplyAML",doc, outDoc);</span></h4>

<h4><br>
&nbsp;</h4>

<h3>VB:</h3>

<h4>Dim url As String = "http://localhost/InnovatorServer"<br>
Dim db As String = "InnovatorSolutions"<br>
Dim user As String = "admin"<br>
Dim pw As String = "innovator"</h4>

<h4>Dim cnx As HttpServerConnection = IomFactory.CreateHttpServerConnection(url, db, user, pw)<br>
Dim login_result As Item = cnx.Login()</h4>

<h4>Dim doc As XmlDocument = Me.newXMLDocument()<br>
Dim root As XmlElement = doc.CreateElement("AML")<br>
Dim item As XmlElement = doc.CreateElement("Item")<br>
item.SetAttribute("type", "User")<br>
item.SetAttribute("action", "get")<br>
doc.AppendChild(root)<br>
root.AppendChild(item)</h4>

<h4>Dim outDoc As XmlDocument = Me.newXMLDocument()</h4>

<h4><span style="background-color: rgb(255, 255, 0);">cnx.CallAction("ApplyAML", doc, outDoc)</span></h4>

<h3>Notes:</h3>

<p><span class="parameter">This method expects an action name (e.</span>g. "ApplyAML", etc.) and and inDom and outDom XmlDocument.</p>

<p>The inDom contains the request and the outDom is filled with the server response.</p>

<p>In the examples above, a request is made to get a list of Users from
the server.&nbsp; The list is contained in the outDom document after
the CallAction is made.</p>

<dl paramname="actionName">
	<dt>&nbsp;</dt>
</dl>

<p><br>
<br>
&nbsp;</p>
</body></html>